{
  "name": "9dc7a6e5-a5b7-40e6-b6d5-16273b115931",
  "type": "Microsoft.Authorization/policyDefinitions",
  "properties": {
    "displayName": "Audit unattached static Public IPs",
    "mode": "All",
    "description": "Static Public IPs incur cost even when not in use. This Policy will help you detect the existence of unattached static Public IPs in the effort to help drive down cost.",
    "metaData": {
      "category": "Network",
      "version": "1.0.0"
    },
    "parameters": {
      "effect": {
        "allowedValues": [
          "Audit",
          "Disabled"
        ],
        "defaultValue": "Audit",
        "type": "string",
        "metaData": {
          "description": "Audit or Disable the execution of the Policy",
          "displayName": "Policy effect"
        }
      }
    },
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.Network/publicIPAddresses"
          },
          {
            "field": "Microsoft.Network/publicIPAddresses/publicIPAllocationMethod",
            "equals": "Static"
          },
          {
            "field": "Microsoft.Network/publicIPAddresses/ipConfiguration",
            "exists": false
          }
        ]
      },
      "then": {
        "effect": "[parameters('effect')]"
      }
    }
  }
}
